"use strict";(self.webpackChunkkasa=self.webpackChunkkasa||[]).push([[759,775],{1541:(e,s,t)=>{t.d(s,{A:()=>i});t(5043);var a=t(9367),n=t(579);const i=e=>{let{title:s,description:t,keywords:i,children:r}=e;return(0,n.jsxs)(a.mg,{children:[(0,n.jsx)("title",{children:s?"".concat(s," | Kasa"):"Kasa - Trouvez le logement de vos r\xeaves"}),(0,n.jsx)("meta",{name:"description",content:t||"D\xe9couvrez des milliers de logements uniques pour votre prochain voyage. Kasa vous met en relation avec des h\xf4tes de confiance."}),i&&(0,n.jsx)("meta",{name:"keywords",content:i}),r]})}},4887:(e,s,t)=>{t.d(s,{A:()=>n});t(5043);var a=t(579);const n=e=>{let{tags:s=[],reviews:t=[],host:n={name:"H\xf4te inconnu",picture:""},title:i,location:r,id:c,onBooking:l,titleAs:o="h3",price:d}=e;return(0,a.jsx)("div",{className:"houseCard",children:(0,a.jsxs)("div",{children:[(0,a.jsx)(o,{className:"houseCard__title",children:i}),(0,a.jsx)("p",{className:"houseCard__location",children:r}),d&&(0,a.jsxs)("p",{className:"houseCard__price",children:[d,"\u20ac / nuit"]}),(0,a.jsx)("div",{className:"houseCard__tags",children:s.map(e=>(0,a.jsx)("p",{className:"houseCard__tag",children:e},e))})]})},c)}},6062:(e,s,t)=>{t.r(s),t.d(s,{default:()=>q});var a,n=t(9379),i=t(5043),r=t(3216),c=t(1541),l=t(6472),o=t(4887),d=t(8174);const u=["title","titleId"];function h(){return h=Object.assign?Object.assign.bind():function(e){for(var s=1;s<arguments.length;s++){var t=arguments[s];for(var a in t)({}).hasOwnProperty.call(t,a)&&(e[a]=t[a])}return e},h.apply(null,arguments)}function m(e,s){let{title:t,titleId:n}=e,r=function(e,s){if(null==e)return{};var t,a,n=function(e,s){if(null==e)return{};var t={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(-1!==s.indexOf(a))continue;t[a]=e[a]}return t}(e,s);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)t=i[a],-1===s.indexOf(t)&&{}.propertyIsEnumerable.call(e,t)&&(n[t]=e[t])}return n}(e,u);return i.createElement("svg",h({width:30,height:30,viewBox:"0 0 30 30",fill:"current",xmlns:"http://www.w3.org/2000/svg",ref:s,"aria-labelledby":n},r),t?i.createElement("title",{id:n},t):null,a||(a=i.createElement("path",{d:"M18.645 12L15 0L11.355 12H0L9.27 18.615L5.745 30L15 22.965L24.27 30L20.745 18.615L30 12H18.645Z",fill:"current"})))}const p=i.forwardRef(m);t.p;var g=t(579);const x=e=>{let{rating:s}=e;const t=[],a=Math.round(s);for(let n=0;n<5;n++){const e=a>n?"#FF6060":"#E3E3E3";t.push((0,g.jsx)(p,{fill:e},n))}return(0,g.jsx)("div",{className:"houseCard__rating",children:t})},v=e=>{let{review:s}=e;const{author:t,rating:a,comment:n,date:i,detailedRating:r}=s,c=new Date(i).toLocaleDateString("fr-FR",{year:"numeric",month:"long",day:"numeric"});return(0,g.jsxs)("div",{className:"reviewCard",children:[(0,g.jsxs)("div",{className:"reviewCard__header",children:[(0,g.jsx)("p",{className:"reviewCard__author",children:t}),(0,g.jsx)("p",{className:"reviewCard__date",children:c})]}),(0,g.jsx)("div",{className:"reviewCard__rating",children:(0,g.jsx)(x,{rating:a})}),(0,g.jsx)("p",{className:"reviewCard__comment",children:n}),r&&(0,g.jsxs)("div",{className:"reviewCard__detailed-rating",children:[(0,g.jsxs)("div",{className:"detailed-rating__item",children:[(0,g.jsx)("span",{children:"Propret\xe9"}),(0,g.jsx)(x,{rating:r.cleanliness})]}),(0,g.jsxs)("div",{className:"detailed-rating__item",children:[(0,g.jsx)("span",{children:"Communication"}),(0,g.jsx)(x,{rating:r.communication})]}),(0,g.jsxs)("div",{className:"detailed-rating__item",children:[(0,g.jsx)("span",{children:"Arriv\xe9e"}),(0,g.jsx)(x,{rating:r.checkin})]}),(0,g.jsxs)("div",{className:"detailed-rating__item",children:[(0,g.jsx)("span",{children:"Pr\xe9cision"}),(0,g.jsx)(x,{rating:r.accuracy})]}),(0,g.jsxs)("div",{className:"detailed-rating__item",children:[(0,g.jsx)("span",{children:"Emplacement"}),(0,g.jsx)(x,{rating:r.location})]}),(0,g.jsxs)("div",{className:"detailed-rating__item",children:[(0,g.jsx)("span",{children:"Rapport qualit\xe9-prix"}),(0,g.jsx)(x,{rating:r.value})]})]})]})},j=e=>{let{label:s,name:t,value:a,onChange:n}=e;return(0,g.jsxs)("div",{className:"rating-input",children:[(0,g.jsx)("label",{children:s}),(0,g.jsx)("div",{className:"stars",children:[...Array(5)].map((e,s)=>{const i=s+1;return(0,g.jsx)("span",{className:i<=a?"star-filled":"star-empty",onClick:()=>n(t,i),children:"\u2605"},i)})})]})},_=e=>{let{logementId:s,onReviewSubmit:t,token:a}=e;const[r,c]=(0,i.useState)(""),[l,o]=(0,i.useState)(""),[d,u]=(0,i.useState)({cleanliness:0,communication:0,checkin:0,accuracy:0,location:0,value:0}),h=(e,s)=>{u(t=>(0,n.A)((0,n.A)({},t),{},{[e]:s}))};return(0,g.jsxs)("form",{className:"reviewForm",onSubmit:e=>{e.preventDefault();const n=Object.values(d).reduce((e,s)=>e+s,0)/Object.values(d).length,i={logementId:s,review:{author:r,comment:l,rating:Math.round(10*n)/10,date:(new Date).toISOString(),detailedRating:d}};fetch("".concat("https://kasa-backend.onrender.com/api","/logements/").concat(s,"/reviews"),{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(a)},body:JSON.stringify(i.review)}).then(e=>{if(!e.ok)throw new Error("Failed to submit review");return e.json()}).then(e=>{t(e),c(""),o(""),u({cleanliness:0,communication:0,checkin:0,accuracy:0,location:0,value:0})}).catch(e=>{console.error("Error submitting review:",e),alert("Erreur lors de l'envoi de l'avis. Veuillez vous connecter et r\xe9essayer.")})},children:[(0,g.jsx)("h3",{children:"Laissez un avis"}),(0,g.jsx)("input",{type:"text",placeholder:"Votre nom",value:r,onChange:e=>c(e.target.value),required:!0}),(0,g.jsx)("textarea",{placeholder:"Votre commentaire",value:l,onChange:e=>o(e.target.value),required:!0}),(0,g.jsxs)("div",{className:"reviewForm__detailed-ratings",children:[(0,g.jsx)(j,{label:"Propret\xe9",name:"cleanliness",value:d.cleanliness,onChange:h}),(0,g.jsx)(j,{label:"Communication",name:"communication",value:d.communication,onChange:h}),(0,g.jsx)(j,{label:"Arriv\xe9e",name:"checkin",value:d.checkin,onChange:h}),(0,g.jsx)(j,{label:"Pr\xe9cision",name:"accuracy",value:d.accuracy,onChange:h}),(0,g.jsx)(j,{label:"Emplacement",name:"location",value:d.location,onChange:h}),(0,g.jsx)(j,{label:"Rapport qualit\xe9-prix",name:"value",value:d.value,onChange:h})]}),(0,g.jsx)("button",{type:"submit",children:"Envoyer"})]})},w=e=>{let{reviews:s,logementId:t,onReviewSubmit:a,token:n}=e;return s&&0!==s.length?(0,g.jsxs)("div",{className:"reviewsSection",children:[(0,g.jsxs)("h2",{className:"reviewsSection__title",children:["Avis des clients (",s.length,")"]}),(0,g.jsx)("div",{className:"reviewsSection__list",children:s.map((e,s)=>(0,g.jsx)(v,{review:e},s))}),(0,g.jsx)(_,{logementId:t,onReviewSubmit:a,token:n})]}):(0,g.jsxs)("div",{className:"reviewsSection",children:[(0,g.jsx)("h2",{className:"reviewsSection__title",children:"Avis des clients"}),(0,g.jsx)("p",{className:"reviewsSection__no-reviews",children:"Il n'y a pas encore d'avis pour ce logement."})]})},A=e=>{let{pictures:s,title:t}=e;const[a,n]=(0,i.useState)(0),r=(0,i.useCallback)(()=>{n(e=>e===s.length-1?0:e+1)},[s.length]),c=(0,i.useCallback)(()=>{n(e=>0===e?s.length-1:e-1)},[s.length]);if((0,i.useEffect)(()=>{const e=e=>{s.length<=1||("ArrowRight"===e.key?r():"ArrowLeft"===e.key&&c())};return window.addEventListener("keydown",e),()=>{window.removeEventListener("keydown",e)}},[r,c,s.length]),!s||0===s.length)return null;const l=s.length>1;return(0,g.jsxs)("div",{className:"carousel","aria-roledescription":"carousel","aria-label":"Image gallery for ".concat(t),children:[(0,g.jsx)("div",{className:"carousel__inner",children:s.map((e,s)=>(0,g.jsx)("div",{className:"carousel__item ".concat(s===a?"active":""),"aria-hidden":s!==a,children:(0,g.jsx)("img",{className:"carousel__picture",src:e,alt:"".concat(t," - view ").concat(s+1)})},s))}),l&&(0,g.jsxs)(g.Fragment,{children:[(0,g.jsx)("button",{onClick:c,className:"carousel__button carousel__button--prev","aria-label":"Previous image"}),(0,g.jsx)("button",{onClick:r,className:"carousel__button carousel__button--next","aria-label":"Next image"}),(0,g.jsxs)("div",{className:"carousel__pagination","aria-hidden":"true",children:[a+1," / ",s.length]})]})]})},N=e=>{let{reviews:s}=e;if(!s||0===s.length)return null;const t=s.reduce((e,s)=>e+s.rating,0)/s.length,a=s.length;return(0,g.jsxs)("div",{className:"averageRating",children:[(0,g.jsx)(x,{rating:t}),(0,g.jsxs)("p",{className:"averageRating__count",children:["(",a," avis)"]})]})};var b=t(5475),f=t(5227),k=(t(5015),t(2227)),y=t(5187);(0,f.E)("fr",k.A);const S=e=>{let{houseId:s,price:t}=e;const a=(0,r.Zp)(),{user:n}=(0,y.As)(),[c,l]=(0,i.useState)(null),[o,d]=(0,i.useState)(null),[u,h]=(0,i.useState)(0),[m,p]=(0,i.useState)(""),[x,v]=(0,i.useState)(""),[j,_]=(0,i.useState)([]);(0,i.useEffect)(()=>{s&&(async()=>{try{const e=await fetch("".concat("https://kasa-backend.onrender.com/api","/houses/").concat(s,"/bookings"));if(!e.ok)throw new Error("Could not fetch booking data.");const t=(await e.json()).map(e=>({start:new Date(e.startDate),end:new Date(e.endDate)}));_(t)}catch(e){console.error("Error fetching booked dates:",e.message)}})()},[s]);return n?(0,g.jsxs)("div",{className:"booking-widget",children:[(0,g.jsx)("h3",{children:"R\xe9server ce logement"}),(0,g.jsxs)("form",{onSubmit:async e=>{if(e.preventDefault(),p(""),v(""),n)if(c&&o)try{const e=localStorage.getItem("token"),t=await fetch("".concat("https://kasa-backend.onrender.com/api","/bookings"),{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(e)},body:JSON.stringify({houseId:s,startDate:c.toISOString().split("T")[0],endDate:o.toISOString().split("T")[0]})});if(!t.ok){const e=await t.json();throw new Error(e.message||"La r\xe9servation a \xe9chou\xe9.")}const n=await t.json();v("R\xe9servation r\xe9ussie !"),a("/booking-confirmation/".concat(n.booking.id)),_(e=>[...e,{start:c,end:o}]),l(null),d(null)}catch(t){p(t.message)}else p("Veuillez s\xe9lectionner une date de d\xe9but et de fin.");else p("Vous devez \xeatre connect\xe9 pour r\xe9server.")},children:[(0,g.jsx)("div",{className:"booking-widget__datepicker-container",children:(0,g.jsx)(f.Ay,{selected:c,onChange:e=>{const[s,a]=e;if(l(s),d(a),s&&a){const e=Math.abs(a.getTime()-s.getTime()),n=Math.ceil(e/864e5);h(n*t)}else h(0)},startDate:c,endDate:o,excludeDateIntervals:j,selectsRange:!0,inline:!0,minDate:new Date,monthsShown:2,locale:"fr",dateFormat:"P"})}),c&&o&&(0,g.jsxs)("div",{className:"booking-widget__summary",children:[(0,g.jsxs)("p",{children:["Nombre de nuits : ",Math.ceil(Math.abs(o.getTime()-c.getTime())/864e5)]}),(0,g.jsxs)("p",{children:["Prix par nuit : ",t,"\u20ac"]}),(0,g.jsxs)("p",{className:"booking-widget__total-price",children:["Prix total : ",u,"\u20ac"]})]}),(0,g.jsx)("button",{type:"submit",disabled:!c||!o,children:"R\xe9server"}),m&&(0,g.jsx)("p",{className:"error-message",children:m}),x&&(0,g.jsx)("p",{className:"success-message",children:x})]})]}):(0,g.jsx)("div",{className:"booking-widget",children:(0,g.jsxs)("div",{className:"booking-widget__login-prompt",children:[(0,g.jsx)(b.N_,{to:"/login",children:"Connectez-vous"})," ou ",(0,g.jsx)(b.N_,{to:"/signup",children:"inscrivez-vous"})," pour r\xe9server."]})})},C=e=>{let{house:s}=e;const{host:t,reviews:a,id:n,price:i}=s,{user:r}=(0,y.As)(),c=t.name?t.name.split(" "):["H\xf4te","Inconnu"];return(0,g.jsxs)("div",{className:"house-sidebar",children:[(0,g.jsxs)("div",{className:"house-sidebar__host-info",children:[(0,g.jsxs)("div",{className:"house-sidebar__host",children:[(0,g.jsxs)("p",{className:"house-sidebar__name",children:[c[0]," ",(0,g.jsx)("br",{}),c.slice(1).join(" ")]}),(0,g.jsx)("img",{className:"house-sidebar__picture",src:t.picture,alt:"Portrait de ".concat(t.name)})]}),(0,g.jsx)("div",{className:"house-sidebar__rating",children:(0,g.jsx)(N,{reviews:a})})]}),r&&(0,g.jsx)(S,{houseId:n,price:i})]})};var E=t(9759),R=t(9419),O=t(9349),I=t(6036),D=t(3318),L=t(228),P=t.n(L),z=t(2934);const B=new(P().Icon)({iconUrl:z,iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34]}),F=e=>{let{coordinates:s,locationName:t}=e;if(!s||!s.latitude||!s.longitude)return(0,g.jsx)("div",{children:"Les coordonn\xe9es de g\xe9olocalisation ne sont pas disponibles pour ce logement."});const a=[s.latitude,s.longitude];return(0,g.jsxs)(R.W,{center:a,zoom:13,scrollWheelZoom:!1,className:"map-container",children:[(0,g.jsx)(O.e,{attribution:'\xa9 <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors',url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png"}),(0,g.jsx)(I.p,{position:a,icon:B,children:(0,g.jsx)(D.z,{children:t})})]})},T=e=>{let{logement:s}=e;return(0,g.jsxs)("div",{className:"location-section",children:[(0,g.jsx)("h3",{children:"Localisation"}),(0,g.jsx)("p",{children:s.location}),(0,g.jsx)(F,{coordinates:s.coordinates,locationName:s.title})]})},q=()=>{const{id:e}=(0,r.g)(),[s,t]=(0,i.useState)(null),[a,u]=(0,i.useState)(!0),[h,m]=(0,i.useState)(!1),p=localStorage.getItem("token");if((0,i.useEffect)(()=>{u(!0),m(!1),fetch("".concat("https://kasa-backend.onrender.com/api","/logements/").concat(e)).then(e=>{if(!e.ok)throw new Error("House not found");return e.json()}).then(e=>{t(e),u(!1)}).catch(e=>{console.error("Failed to fetch house data:",e),m(!0),u(!1)})},[e]),a)return(0,g.jsx)("div",{children:"Loading..."});if(h||!s)return(0,g.jsx)(E.default,{});const x="D\xe9couvrez ce logement d'exception : ".concat(s.title,", situ\xe9 \xe0 ").concat(s.location,". Profitez d'un s\xe9jour inoubliable."),v={"@context":"https://schema.org","@type":"LodgingBusiness",name:s.title,description:s.description,image:s.pictures,address:{"@type":"PostalAddress",addressLocality:s.location.split(" - ")[1]||s.location,addressCountry:"FR"},starRating:{"@type":"Rating",ratingValue:s.rating}};return(0,g.jsxs)(g.Fragment,{children:[(0,g.jsx)(c.A,{title:s.title,description:x,children:(0,g.jsx)("script",{type:"application/ld+json",children:JSON.stringify(v)})}),(0,g.jsxs)("main",{className:"kasa__wrapper fade-in",children:[(0,g.jsx)(d.A,{}),(0,g.jsx)(A,{pictures:s.pictures,title:s.title}),(0,g.jsxs)("div",{className:"house-page__layout",children:[(0,g.jsxs)("div",{className:"house-page__main-content",children:[(0,g.jsx)(o.A,{title:s.title,titleAs:"h1",location:s.location,tags:s.tags,host:s.host,reviews:s.reviews,price:s.price},s.id),(0,g.jsxs)("div",{className:"collapse__wrapper -housePage",children:[(0,g.jsx)(l.A,{title:"Description",text:s.description},"Description"),(0,g.jsx)(l.A,{title:"\xc9quipements",text:s.equipments.join(", ")},"\xc9quipements")]}),(0,g.jsx)(T,{logement:s})]}),(0,g.jsx)(C,{house:s})]}),(0,g.jsx)(w,{reviews:s.reviews,logementId:s.id,onReviewSubmit:e=>{t(s=>(0,n.A)((0,n.A)({},s),{},{reviews:[...s.reviews,e]}))},token:p})]})]})}},6472:(e,s,t)=>{t.d(s,{A:()=>i});var a=t(5043);var n=t(579);const i=e=>{let{title:s,text:t}=e;const[i,r]=(0,a.useState)(!1),c=(0,a.useRef)(null);return(0,n.jsxs)("section",{className:"collapse__item",children:[(0,n.jsxs)("button",{className:"collapse__titleWrapper",onClick:()=>{r(!i)},"aria-expanded":i,"aria-controls":"collapse-content-".concat(s.replace(/\s/g,"-")),children:[(0,n.jsx)("h2",{className:"collapse__title",children:s}),(0,n.jsx)("img",{className:"collapse__icon ".concat(i?"open":""),src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABkAAAAPCAYAAAARZmTlAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAABwSURBVHgBtc/RCcAwCARQR+gI2ayjdKSO0FE6ihWaQJEmRr0c+CNyD4kWhZk3vSgyt8xOgEjPUfuKBlpSUAVaXugHCUMKYOsbNzQEPkdhaArIQC4gAoUAD5QCZiAIYEAnDDAgHGBAOKAD4QEFXV7gASXf9q3YZSdUAAAAAElFTkSuQmCC",alt:""})]}),(0,n.jsx)("div",{id:"collapse-content-".concat(s.replace(/\s/g,"-")),ref:c,className:"collapse__content-wrapper ".concat(i?"open":""),style:{maxHeight:i?"".concat(c.current.scrollHeight,"px"):"0px"},children:(0,n.jsx)("div",{className:"collapse__text",children:Array.isArray(t)?(0,n.jsx)("ul",{className:"collapse__list",children:t.map((e,s)=>(0,n.jsx)("li",{children:e},s))}):(0,n.jsx)("p",{children:t})})})]})}},8174:(e,s,t)=>{t.d(s,{A:()=>c});t(5043);var a=t(5475),n=t(985),i=t(7929),r=t(579);const c=()=>(0,r.jsxs)(a.N_,{to:"/",className:"back-link",children:[(0,r.jsx)(n.g,{icon:i.Wzs}),(0,r.jsx)("span",{children:"Retour \xe0 l'accueil"})]})},9759:(e,s,t)=>{t.r(s),t.d(s,{default:()=>o});var a=t(5043),n=t(1541),i=t(5475),r=t(579);class c extends a.Component{render(){return(0,r.jsxs)("div",{className:"error",children:[(0,r.jsx)("h2",{className:"error__404",children:"404"}),(0,r.jsx)("p",{className:"error__text",children:"Oups ! La page que vous demandez n'existe pas."}),(0,r.jsx)(i.k2,{to:"/",className:"error__homeLink",children:"Retourner sur la page d\u2019accueil"})]})}}const l=c,o=()=>(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.A,{title:"Page non trouv\xe9e (404)",description:"La page que vous cherchez n'existe pas ou a \xe9t\xe9 d\xe9plac\xe9e."}),(0,r.jsx)("main",{className:"kasa__wrapper -paddingBottom fade-in",children:(0,r.jsx)(l,{})})]})}}]);
//# sourceMappingURL=775.bb3170b7.chunk.js.map