"use strict";(self.webpackChunkkasa=self.webpackChunkkasa||[]).push([[759,780],{435:(e,s,t)=>{t.d(s,{A:()=>n});var a=t(5043),r=t(579);const n=e=>{let{title:s,text:t}=e;const[n,i]=(0,a.useState)(!1),c=(0,a.useRef)(null);return(0,r.jsxs)("section",{className:"collapse__item",children:[(0,r.jsxs)("button",{className:"collapse__titleWrapper",onClick:()=>{i(!n)},"aria-expanded":n,"aria-controls":"collapse-content-".concat(s.replace(/\s/g,"-")),children:[(0,r.jsx)("h2",{className:"collapse__title",children:s}),(0,r.jsx)("span",{className:"collapse__icon ".concat(n?"open":"")})]}),(0,r.jsx)("div",{id:"collapse-content-".concat(s.replace(/\s/g,"-")),ref:c,className:"collapse__content-wrapper ".concat(n?"open":""),style:{maxHeight:n?"".concat(c.current.scrollHeight,"px"):"0px"},children:(0,r.jsx)("div",{className:"collapse__text",children:Array.isArray(t)?(0,r.jsx)("ul",{className:"collapse__list",children:t.map((e,s)=>(0,r.jsx)("li",{children:e},s))}):(0,r.jsx)("p",{children:t})})})]})}},1541:(e,s,t)=>{t.d(s,{A:()=>n});t(5043);var a=t(9367),r=t(579);const n=e=>{let{title:s,description:t,keywords:n,children:i}=e;return(0,r.jsxs)(a.mg,{children:[(0,r.jsx)("title",{children:s?"".concat(s," | Kasa"):"Kasa - Trouvez le logement de vos r\xeaves"}),(0,r.jsx)("meta",{name:"description",content:t||"D\xe9couvrez des milliers de logements uniques pour votre prochain voyage. Kasa vous met en relation avec des h\xf4tes de confiance."}),n&&(0,r.jsx)("meta",{name:"keywords",content:n}),i]})}},3389:(e,s,t)=>{t.r(s),t.d(s,{default:()=>T});var a=t(9379),r=t(5043),n=t(3216),i=t(1541),c=t(435),l=t(4887),o=t(8174),d=t(579);const u=e=>{let{rating:s}=e;const t=Math.round(s);return(0,d.jsx)("div",{className:"star-rating",children:[...Array(5)].map((e,s)=>(0,d.jsx)("span",{className:s<t?"star -filled":"star",children:"\u2605"},s))})},h=e=>{let{reviews:s=[],logementId:t,onReviewSubmit:a,token:n}=e;const[i,c]=(0,r.useState)("");return(0,d.jsxs)("div",{className:"reviews-section",children:[(0,d.jsxs)("h2",{className:"reviews-section__title",children:["Avis des clients (",s.length,")"]}),(0,d.jsx)("div",{className:"reviews-list",children:s.map(e=>(0,d.jsxs)("div",{className:"review-card",children:[(0,d.jsxs)("div",{className:"review-card__header",children:[(0,d.jsxs)("div",{className:"review-card__author-info",children:[(0,d.jsx)("p",{className:"review-card__author",children:e.author}),(0,d.jsx)("p",{className:"review-card__date",children:e.date})]}),(0,d.jsx)("div",{className:"review-card__rating",children:(0,d.jsx)(u,{rating:e.rating})})]}),(0,d.jsx)("p",{className:"review-card__comment",children:e.comment}),e.details&&(0,d.jsx)("div",{className:"review-card__details",children:Object.entries(e.details).map(e=>{let[s,t]=e;return(0,d.jsxs)("div",{className:"review-detail",children:[(0,d.jsx)("span",{className:"review-detail__name",children:s}),(0,d.jsx)("div",{className:"review-detail__rating",children:(0,d.jsx)(u,{rating:t})})]},s)})})]},e.id||e.author))}),(0,d.jsxs)("div",{className:"review-form-wrapper",children:[(0,d.jsx)("h3",{children:"Laissez un avis"}),(0,d.jsxs)("form",{onSubmit:e=>{e.preventDefault()},className:"review-form",children:[(0,d.jsx)("textarea",{className:"review-form__textarea",placeholder:"Votre commentaire",value:i,onChange:e=>c(e.target.value),required:!0}),(0,d.jsx)("button",{type:"submit",className:"review-form__button",children:"Envoyer"})]})]})]})};var m=t(3652);const p=e=>{let{pictures:s,title:t}=e;const[n,i]=(0,r.useState)(0),[c,l]=(0,r.useState)({}),o=(0,r.useCallback)(()=>{i(e=>e===s.length-1?0:e+1)},[s.length]),u=(0,r.useCallback)(()=>{i(e=>0===e?s.length-1:e-1)},[s.length]);(0,r.useEffect)(()=>{const e=e=>{s.length<=1||("ArrowRight"===e.key?o():"ArrowLeft"===e.key&&u())};return window.addEventListener("keydown",e),()=>{window.removeEventListener("keydown",e)}},[o,u,s.length]);if(!s||0===s.length)return(0,d.jsx)("div",{className:"carousel carousel--no-pictures",children:(0,d.jsx)("div",{className:"carousel__placeholder",children:(0,d.jsx)("img",{src:m,alt:"Kasa Logo",className:"carousel__placeholder-logo"})})});const h=s.length>1;return(0,d.jsxs)("div",{className:"carousel","aria-roledescription":"carousel","aria-label":"Image gallery for ".concat(t),children:[(0,d.jsx)("div",{className:"carousel__inner",children:s.map((e,s)=>(0,d.jsx)("div",{className:"carousel__item ".concat(s===n?"active":""),"aria-hidden":s!==n,children:c[s]?(0,d.jsx)("div",{className:"carousel__placeholder",children:(0,d.jsx)("img",{src:m,alt:"Kasa Logo",className:"carousel__placeholder-logo"})}):(0,d.jsx)("img",{className:"carousel__picture",src:e,alt:"".concat(t," - view ").concat(s+1),onError:()=>(e=>{l(s=>(0,a.A)((0,a.A)({},s),{},{[e]:!0}))})(s)})},s))}),h&&(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)("button",{onClick:u,className:"carousel__button carousel__button--prev","aria-label":"Previous image"}),(0,d.jsx)("button",{onClick:o,className:"carousel__button carousel__button--next","aria-label":"Next image"}),(0,d.jsxs)("div",{className:"carousel__pagination","aria-hidden":"true",children:[n+1," / ",s.length]})]})]})};var x;const g=["title","titleId"];function j(){return j=Object.assign?Object.assign.bind():function(e){for(var s=1;s<arguments.length;s++){var t=arguments[s];for(var a in t)({}).hasOwnProperty.call(t,a)&&(e[a]=t[a])}return e},j.apply(null,arguments)}function v(e,s){let{title:t,titleId:a}=e,n=function(e,s){if(null==e)return{};var t,a,r=function(e,s){if(null==e)return{};var t={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(-1!==s.indexOf(a))continue;t[a]=e[a]}return t}(e,s);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);for(a=0;a<n.length;a++)t=n[a],-1===s.indexOf(t)&&{}.propertyIsEnumerable.call(e,t)&&(r[t]=e[t])}return r}(e,g);return r.createElement("svg",j({width:30,height:30,viewBox:"0 0 30 30",fill:"current",xmlns:"http://www.w3.org/2000/svg",ref:s,"aria-labelledby":a},n),t?r.createElement("title",{id:a},t):null,x||(x=r.createElement("path",{d:"M18.645 12L15 0L11.355 12H0L9.27 18.615L5.745 30L15 22.965L24.27 30L20.745 18.615L30 12H18.645Z",fill:"current"})))}const _=r.forwardRef(v),N=(t.p,e=>{let{rating:s}=e;const t=[],a=Math.round(s);for(let r=0;r<5;r++){const e=a>r?"#FF6060":"#E3E3E3";t.push((0,d.jsx)(_,{fill:e},r))}return(0,d.jsx)("div",{className:"houseCard__rating",children:t})}),w=e=>{let{reviews:s}=e;if(!s||0===s.length)return null;const t=s.reduce((e,s)=>e+s.rating,0)/s.length,a=s.length;return(0,d.jsxs)("div",{className:"averageRating",children:[(0,d.jsx)(N,{rating:t}),(0,d.jsxs)("p",{className:"averageRating__count",children:["(",a," avis)"]})]})};var f=t(5475),b=t(5227),k=(t(5015),t(2227)),y=t(5187);(0,b.E)("fr",k.A);const S=e=>{let{houseId:s,price:t}=e;const a=(0,n.Zp)(),{user:i}=(0,y.As)(),[c,l]=(0,r.useState)(null),[o,u]=(0,r.useState)(null),[h,m]=(0,r.useState)(0),[p,x]=(0,r.useState)(""),[g,j]=(0,r.useState)(""),[v,_]=(0,r.useState)([]);(0,r.useEffect)(()=>{s&&(async()=>{try{const e=await fetch("".concat("https://kasa-backend.onrender.com/api","/houses/").concat(s,"/bookings"));if(!e.ok)throw new Error("Could not fetch booking data.");const t=(await e.json()).map(e=>({start:new Date(e.startDate),end:new Date(e.endDate)}));_(t)}catch(e){console.error("Error fetching booked dates:",e.message)}})()},[s]);return i?(0,d.jsxs)("div",{className:"booking-widget",children:[(0,d.jsx)("h3",{children:"R\xe9server ce logement"}),(0,d.jsxs)("form",{onSubmit:async e=>{if(e.preventDefault(),x(""),j(""),i)if(c&&o)try{const e=localStorage.getItem("token"),t=await fetch("".concat("https://kasa-backend.onrender.com/api","/bookings"),{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(e)},body:JSON.stringify({houseId:s,startDate:c.toISOString().split("T")[0],endDate:o.toISOString().split("T")[0]})});if(!t.ok){const e=await t.json();throw new Error(e.message||"La r\xe9servation a \xe9chou\xe9.")}const r=await t.json();j("R\xe9servation r\xe9ussie !"),a("/booking-confirmation/".concat(r.booking.id)),_(e=>[...e,{start:c,end:o}]),l(null),u(null)}catch(t){x(t.message)}else x("Veuillez s\xe9lectionner une date de d\xe9but et de fin.");else x("Vous devez \xeatre connect\xe9 pour r\xe9server.")},children:[(0,d.jsx)("div",{className:"booking-widget__datepicker-container",children:(0,d.jsx)(b.Ay,{selected:c,onChange:e=>{const[s,a]=e;if(l(s),u(a),s&&a){const e=Math.abs(a.getTime()-s.getTime()),r=Math.ceil(e/864e5);m(r*t)}else m(0)},startDate:c,endDate:o,excludeDateIntervals:v,selectsRange:!0,inline:!0,minDate:new Date,monthsShown:2,locale:"fr",dateFormat:"P"})}),c&&o&&(0,d.jsxs)("div",{className:"booking-widget__summary",children:[(0,d.jsxs)("p",{children:["Nombre de nuits : ",Math.ceil(Math.abs(o.getTime()-c.getTime())/864e5)]}),(0,d.jsxs)("p",{children:["Prix par nuit : ",t,"\u20ac"]}),(0,d.jsxs)("p",{className:"booking-widget__total-price",children:["Prix total : ",h,"\u20ac"]})]}),(0,d.jsx)("button",{type:"submit",disabled:!c||!o,children:"R\xe9server"}),p&&(0,d.jsx)("p",{className:"error-message",children:p}),g&&(0,d.jsx)("p",{className:"success-message",children:g})]})]}):(0,d.jsx)("div",{className:"booking-widget",children:(0,d.jsxs)("div",{className:"booking-widget__login-prompt",children:[(0,d.jsx)(f.N_,{to:"/login",children:"Connectez-vous"})," ou ",(0,d.jsx)(f.N_,{to:"/signup",children:"inscrivez-vous"})," pour r\xe9server."]})})},A=e=>{let{house:s}=e;const{host:t,reviews:a,id:n,price:i}=s,{user:c}=(0,y.As)(),[l,o]=(0,r.useState)(!1),u=t.name?t.name.split(" "):["H\xf4te","Inconnu"];return(0,d.jsxs)("div",{className:"house-sidebar",children:[(0,d.jsxs)("div",{className:"house-sidebar__host-info",children:[(0,d.jsxs)("div",{className:"house-sidebar__host",children:[(0,d.jsxs)("p",{className:"house-sidebar__name",children:[u[0]," ",(0,d.jsx)("br",{}),u.slice(1).join(" ")]}),l||!t.picture?(0,d.jsx)("div",{className:"house-sidebar__picture-placeholder"}):(0,d.jsx)("img",{className:"house-sidebar__picture",src:t.picture,alt:"Portrait de ".concat(t.name),onError:()=>o(!0)})]}),(0,d.jsx)("div",{className:"house-sidebar__rating",children:(0,d.jsx)(w,{reviews:a})})]}),c&&(0,d.jsx)(S,{houseId:n,price:i})]})};var C=t(9759),L=t(9419),E=t(9349),O=t(6036),z=t(3318),D=t(228),I=t.n(D);t(6467);const R=e=>{let{coordinates:s,locationName:t,price:a}=e;if(!s||!s.latitude||!s.longitude)return(0,d.jsx)("div",{children:"Les coordonn\xe9es de g\xe9olocalisation ne sont pas disponibles pour ce logement."});const r=[s.latitude,s.longitude],n=I().divIcon({className:"price-marker",html:"<span>".concat(a,"\u20ac</span>"),iconSize:null,popupAnchor:[0,-20],iconAnchor:[0,0]});return(0,d.jsxs)(L.W,{center:r,zoom:13,scrollWheelZoom:!1,className:"map-container",children:[(0,d.jsx)(E.e,{attribution:'\xa9 <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors',url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png"}),(0,d.jsx)(O.p,{position:r,icon:n,children:(0,d.jsx)(z.z,{className:"map-popup",children:t})})]})},P=e=>{let{logement:s}=e;return(0,d.jsxs)("div",{className:"location-section",children:[(0,d.jsx)("h3",{children:"Localisation"}),(0,d.jsx)("p",{children:s.location}),(0,d.jsx)(R,{coordinates:s.coordinates,locationName:s.title,price:s.price})]})},T=()=>{const{id:e}=(0,n.g)(),[s,t]=(0,r.useState)(null),[u,m]=(0,r.useState)(!0),[x,g]=(0,r.useState)(!1),j=localStorage.getItem("token");if((0,r.useEffect)(()=>{m(!0),g(!1),fetch("".concat("https://kasa-backend.onrender.com/api","/logements/").concat(e)).then(e=>{if(!e.ok)throw new Error("House not found");return e.json()}).then(e=>{t(e),m(!1)}).catch(e=>{console.error("Failed to fetch house data:",e),g(!0),m(!1)})},[e]),u)return(0,d.jsx)("div",{children:"Loading..."});if(x||!s)return(0,d.jsx)(C.default,{});const v="D\xe9couvrez ce logement d'exception : ".concat(s.title,", situ\xe9 \xe0 ").concat(s.location,". Profitez d'un s\xe9jour inoubliable."),_={"@context":"https://schema.org","@type":"LodgingBusiness",name:s.title,description:s.description,image:s.pictures,address:{"@type":"PostalAddress",addressLocality:s.location.split(" - ")[1]||s.location,addressCountry:"FR"},starRating:{"@type":"Rating",ratingValue:s.rating}};return(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(i.A,{title:s.title,description:v,children:(0,d.jsx)("script",{type:"application/ld+json",children:JSON.stringify(_)})}),(0,d.jsxs)("main",{className:"kasa__wrapper fade-in",children:[(0,d.jsx)(o.A,{}),(0,d.jsx)(p,{pictures:s.pictures,title:s.title}),(0,d.jsxs)("div",{className:"house-page__layout",children:[(0,d.jsxs)("div",{className:"house-page__main-content",children:[(0,d.jsx)(l.A,{title:s.title,titleAs:"h1",location:s.location,tags:s.tags,host:s.host,reviews:s.reviews,price:s.price},s.id),(0,d.jsxs)("div",{className:"collapse__wrapper -housePage",children:[(0,d.jsx)(c.A,{title:"Description",text:s.description},"Description"),(0,d.jsx)(c.A,{title:"\xc9quipements",text:s.equipments.join(", ")},"\xc9quipements")]}),(0,d.jsx)(P,{logement:s})]}),(0,d.jsx)(A,{house:s})]}),(0,d.jsx)(h,{reviews:s.reviews,logementId:s.id,onReviewSubmit:e=>{t(s=>(0,a.A)((0,a.A)({},s),{},{reviews:[...s.reviews,e]}))},token:j})]})]})}},4887:(e,s,t)=>{t.d(s,{A:()=>n});t(5043);var a=t(3652),r=t(579);const n=e=>{let{cover:s,tags:t=[],reviews:n=[],host:i={name:"H\xf4te inconnu",picture:""},title:c,location:l,id:o,onBooking:d,titleAs:u="h3",price:h}=e;return(0,r.jsxs)("div",{className:"houseCard",children:[s&&(0,r.jsx)("img",{src:s,alt:c,className:"houseCard__cover"}),!s&&(0,r.jsx)("div",{className:"houseCard__placeholder",children:(0,r.jsx)("img",{src:a,alt:"Kasa Logo",className:"houseCard__placeholder-logo"})}),(0,r.jsxs)("div",{className:"houseCard__content",children:[(0,r.jsx)(u,{className:"houseCard__title",children:c}),(0,r.jsx)("p",{className:"houseCard__location",children:l}),h&&(0,r.jsxs)("p",{className:"houseCard__price",children:[h,"\u20ac / nuit"]}),(0,r.jsx)("div",{className:"houseCard__tags",children:t.map(e=>(0,r.jsx)("p",{className:"houseCard__tag",children:e},e))})]})]},o)}},6467:()=>{},8174:(e,s,t)=>{t.d(s,{A:()=>c});t(5043);var a=t(5475),r=t(985),n=t(7929),i=t(579);const c=()=>(0,i.jsxs)(a.N_,{to:"/",className:"back-link",children:[(0,i.jsx)(r.g,{icon:n.Wzs}),(0,i.jsx)("span",{children:"Retour \xe0 l'accueil"})]})},9759:(e,s,t)=>{t.r(s),t.d(s,{default:()=>o});var a=t(5043),r=t(1541),n=t(5475),i=t(579);class c extends a.Component{render(){return(0,i.jsxs)("div",{className:"error",children:[(0,i.jsx)("h2",{className:"error__404",children:"404"}),(0,i.jsx)("p",{className:"error__text",children:"Oups ! La page que vous demandez n'existe pas."}),(0,i.jsx)(n.k2,{to:"/",className:"error__homeLink",children:"Retourner sur la page d\u2019accueil"})]})}}const l=c,o=()=>(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(r.A,{title:"Page non trouv\xe9e (404)",description:"La page que vous cherchez n'existe pas ou a \xe9t\xe9 d\xe9plac\xe9e."}),(0,i.jsx)("main",{className:"kasa__wrapper -paddingBottom fade-in",children:(0,i.jsx)(l,{})})]})}}]);
//# sourceMappingURL=780.fade17b3.chunk.js.map