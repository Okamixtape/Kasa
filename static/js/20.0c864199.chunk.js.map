{"version":3,"file":"static/js/20.0c864199.chunk.js","mappings":"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","sources":["pages/MyBookingsPage/index.jsx"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport { Helmet } from 'react-helmet-async';\nimport { Link } from 'react-router-dom';\nimport { useAuth } from '../../context/AuthContext';\nimport '../../style/pages/_my-bookings-page.scss';\n\nconst MyBookingsPage = () => {\n    const [bookings, setBookings] = useState([]);\n    const [loading, setLoading] = useState(true);\n    const [error, setError] = useState('');\n    const { user } = useAuth();\n\n    useEffect(() => {\n        if (!user) {\n            setLoading(false);\n            return;\n        }\n\n        const fetchBookings = async () => {\n            setLoading(true);\n            setError('');\n            try {\n                const token = localStorage.getItem('token');\n                                const response = await fetch(`${process.env.REACT_APP_API_URL}/my-bookings`, {\n                    headers: {\n                        'Authorization': `Bearer ${token}`,\n                    },\n                });\n\n                if (!response.ok) {\n                    throw new Error('Failed to fetch bookings');\n                }\n\n                const data = await response.json();\n                setBookings(data);\n            } catch (err) {\n                setError(err.message);\n            } finally {\n                setLoading(false);\n            }\n        };\n\n        fetchBookings();\n    }, [user]);\n\n    const handleCancelBooking = async (bookingId) => {\n        if (!window.confirm('Êtes-vous sûr de vouloir annuler cette réservation ?')) {\n            return;\n        }\n\n        setError('');\n        try {\n            const token = localStorage.getItem('token');\n                        const response = await fetch(`${process.env.REACT_APP_API_URL}/bookings/${bookingId}`, {\n                method: 'DELETE',\n                headers: {\n                    'Authorization': `Bearer ${token}`,\n                },\n            });\n\n            if (!response.ok) {\n                const errorData = await response.json().catch(() => ({}));\n                throw new Error(errorData.message || 'Impossible d\\'annuler la réservation.');\n            }\n\n            // Filter out the cancelled booking from the state\n            setBookings(currentBookings => currentBookings.filter(b => b.id !== bookingId));\n\n        } catch (err) {\n            setError(err.message);\n        }\n    };\n\n    if (loading) {\n        return <div>Loading bookings...</div>;\n    }\n\n    if (!user) {\n        return (\n            <main className=\"kasa__wrapper fade-in kasa__main-container\">\n                <h1>Mes réservations</h1>\n                <p>Veuillez vous <Link to=\"/login\">connecter</Link> pour voir vos réservations.</p>\n            </main>\n        );\n    }\n    \n    if (error) {\n        return <div>Error: {error}</div>;\n    }\n\n    return (\n        <>\n            <Helmet>\n                <title>Mes réservations - Kasa</title>\n                <meta name=\"description\" content=\"Consultez et gérez vos réservations sur Kasa. Retrouvez les détails de vos séjours passés et à venir.\" />\n            </Helmet>\n            <main className=\"kasa__wrapper fade-in my-bookings-page\">\n                <h1>Mes réservations</h1>\n                <p>Retrouvez ici l&apos;historique de vos séjours.</p>\n                <div className=\"bookings-container\">\n                    {bookings.map(booking => (\n                        <div key={booking.id} className=\"booking-card\">\n                            {booking.house ? (\n                                <>\n                                                                        <Link to={`/house/${booking.house.id}`}>\n                                        <img src={booking.house.cover} alt={booking.house.title} className=\"booking-card__image\" />\n                                    </Link>\n                                    <div className=\"booking-card__info\">\n                                                                                <Link to={`/house/${booking.house.id}`} className=\"booking-card__title-link\">\n                                            <h2>{booking.house.title}</h2>\n                                        </Link>\n                                        <p><strong>Du:</strong> {new Date(booking.startDate).toLocaleDateString()}</p>\n                                        <p><strong>Au:</strong> {new Date(booking.endDate).toLocaleDateString()}</p>\n                                        <div className=\"booking-card__actions\">\n                                            <button \n                                                onClick={() => handleCancelBooking(booking.id)} \n                                                className=\"booking-card__cancel-btn\"\n                                            >\n                                                Annuler la réservation\n                                            </button>\n                                        </div>\n                                    </div>\n                                </>\n                            ) : (\n                                <p>Informations sur le logement non disponibles.</p>\n                            )}\n                        </div>\n                    ))}\n                </div>\n            </main>\n        </>\n    );\n};\n\nexport default MyBookingsPage;\n"],"names":["MyBookingsPage","bookings","setBookings","useState","loading","setLoading","error","setError","user","useAuth","useEffect","async","token","localStorage","getItem","response","fetch","concat","process","headers","ok","Error","data","json","err","message","fetchBookings","_jsx","children","_jsxs","_Fragment","Helmet","name","content","className","map","booking","house","Link","to","id","src","cover","alt","title","Date","startDate","toLocaleDateString","endDate","onClick","window","confirm","bookingId","method","errorData","catch","currentBookings","filter","b","handleCancelBooking"],"sourceRoot":""}