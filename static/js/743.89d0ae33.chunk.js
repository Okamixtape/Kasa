"use strict";(self.webpackChunkkasa=self.webpackChunkkasa||[]).push([[743],{9743:(e,t,n)=>{n.r(t),n.d(t,{default:()=>h});var a=n(5043),r=n(9367),s=n(3216),o=n(5187),i=n(9379),l=n(9722),c=n(579);const d=e=>{let{onNext:t,onBack:n}=e;const[r,s]=(0,a.useState)({title:"",address:"",city:"",postalCode:"",description:"",price:"",coordinates:null}),[o,d]=(0,a.useState)(""),u=e=>{const{name:t,value:n}=e.target;s(e=>(0,i.A)((0,i.A)({},e),{},{[t]:n}))};return(0,c.jsxs)("form",{onSubmit:async e=>{e.preventDefault(),d("");const n="".concat(r.address,", ").concat(r.city,", ").concat(r.postalCode);try{const e=await l.A.get("https://nominatim.openstreetmap.org/search",{params:{q:n,format:"json",limit:1},headers:{"User-Agent":"Kasa-App/1.0 (pour un projet \xe9ducatif)"}});if(e.data&&e.data.length>0){const{lat:n,lon:a}=e.data[0],s=(0,i.A)((0,i.A)({},r),{},{coordinates:{latitude:parseFloat(n),longitude:parseFloat(a)}});console.log("Submitting data with coordinates:",s),t(s)}else d("Impossible de v\xe9rifier l'adresse. Veuillez v\xe9rifier les informations saisies.")}catch(o){console.error("Geocoding error:",o),d("Une erreur est survenue lors de la v\xe9rification de l'adresse.")}},className:"add-property-form",children:[(0,c.jsx)("h2",{children:"\xc9tape 2: Ajout de votre premier logement"}),o&&(0,c.jsx)("p",{className:"error-message",children:o}),(0,c.jsx)("input",{name:"title",value:r.title,onChange:u,placeholder:"Titre de l'annonce",required:!0}),(0,c.jsx)("input",{name:"address",value:r.address,onChange:u,placeholder:"Adresse",required:!0}),(0,c.jsx)("input",{name:"city",value:r.city,onChange:u,placeholder:"Ville",required:!0}),(0,c.jsx)("input",{name:"postalCode",value:r.postalCode,onChange:u,placeholder:"Code Postal",required:!0}),(0,c.jsx)("textarea",{name:"description",value:r.description,onChange:u,placeholder:"Description du logement",required:!0}),(0,c.jsx)("input",{name:"price",type:"number",value:r.price,onChange:u,placeholder:"Prix par nuit (\u20ac)",required:!0}),(0,c.jsxs)("div",{children:[(0,c.jsx)("button",{type:"button",onClick:n,children:"Pr\xe9c\xe9dent"}),(0,c.jsx)("button",{type:"submit",children:"Suivant"})]})]})},u=e=>{let{onNext:t}=e;return(0,c.jsxs)("div",{children:[(0,c.jsx)("h2",{children:"\xc9tape 1: V\xe9rification d'identit\xe9"}),(0,c.jsx)("p",{children:"Veuillez fournir une pi\xe8ce d'identit\xe9."}),(0,c.jsx)("button",{onClick:t,children:"Suivant"})]})},p=e=>{let{onNext:t,onBack:n}=e;return(0,c.jsxs)("div",{children:[(0,c.jsx)("h2",{children:"\xc9tape 3: Informations bancaires"}),(0,c.jsx)("p",{children:"Configurez vos informations pour recevoir les paiements."}),(0,c.jsx)("button",{onClick:n,children:"Pr\xe9c\xe9dent"}),(0,c.jsx)("button",{onClick:t,children:"Suivant"})]})},h=()=>{const[e,t]=(0,a.useState)(1),[n,i]=(0,a.useState)(null),{updateUserRole:l,token:h}=(0,o.As)(),m=(0,s.Zp)(),x=(0,a.useCallback)(async()=>{if(n)try{if(!(await fetch("".concat("https://kasa-backend.onrender.com/api","/api/logements"),{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(h)},body:JSON.stringify(n)})).ok)throw new Error("Failed to create listing.");await l("host"),m("/host/dashboard")}catch(e){console.error("Failed to submit property data:",e)}else console.error("Property data is missing.")},[n,m,l,h]);return(0,c.jsxs)("main",{className:"host-onboarding-page container",children:[(0,c.jsx)(r.mg,{children:(0,c.jsx)("title",{children:"Devenez H\xf4te - Kasa"})}),(0,c.jsx)("div",{className:"onboarding-wizard",children:(()=>{switch(e){case 1:default:return(0,c.jsx)(u,{onNext:()=>t(2)});case 2:return(0,c.jsx)(d,{onNext:e=>{i(e),t(3)},onBack:()=>t(1)});case 3:return(0,c.jsx)(p,{onNext:x,onBack:()=>t(2)})}})()})]})}}}]);
//# sourceMappingURL=743.89d0ae33.chunk.js.map